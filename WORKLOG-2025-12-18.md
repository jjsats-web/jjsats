# Worklog (2025-12-18)

## สรุปสิ่งที่ทำวันนี้

- สร้าง/อัปเดต Supabase types ด้วยคำสั่ง `npm run gen:types` (อัปเดตไฟล์ `lib/supabase/database.types.ts`)
- ปรับหน้าใบเสนอราคา (`app/page.tsx`) ให้ flow การเพิ่มสินค้าเป็นแบบ:
  - เลือกสินค้า → เลือกประเภทราคา (Dealer/Project/User) → กดปุ่ม `+ เลือกสินค้า` เพื่อเพิ่มรายการลงตาราง
  - เอาปุ่ม `เพิ่มรายการ`, `จัดการสินค้า`, และ `ล้างใบเสนอราคา` ออก
  - เก็บโค้ดให้ตรงกับ UI ที่ใช้งานจริง (ลบ id/ส่วนที่ไม่ใช้)
- เปลี่ยน Tab Title เป็น `quotation JJSATs` (`app/layout.tsx`)
- เปลี่ยน favicon เป็นไฟล์ใหม่ (แทนที่ `app/favicon.ico`)
- ปรับช่องข้อมูลบริษัท/ระบบในหน้าใบเสนอราคา:
  - เปลี่ยนฟอร์มจาก “ชื่อลูกค้า/อีเมลลูกค้า” → “ชื่อบริษัท/ระบบ” (`components/QuoteForm.tsx`)
  - ปิดไม่ให้กรอกเอง (disabled) และให้ดึงข้อมูลจากการเลือกลูกค้าเท่านั้น
- ทำให้หน้า “ทะเบียนลูกค้า” กด `เลือก` แล้วส่งข้อมูลชื่อบริษัท/ระบบไปกรอกหน้าใบเสนอราคาได้:
  - เพิ่ม `GET /api/customers/[id]` (`app/api/customers/[id]/route.ts`)
  - หน้า `/` อ่าน query `?customer=<id>` แล้ว fetch ข้อมูลลูกค้าไปเติม `companyName/systemName` (`app/page.tsx`)
  - แก้ issue build ของ `useSearchParams()` โดยห่อด้วย `Suspense` (`app/page.tsx`)
- ปรับ UI หน้า “ทะเบียนลูกค้า”:
  - เปลี่ยนข้อความปุ่มจาก “+ เพิ่มสินค้าให้ลูกค้ารายนี้” เป็น “เลือก”
  - ทำปุ่ม/ลิงก์ให้หน้าตาเหมือนกันด้วยคลาส `.card-action-link` (`app/globals.css`)
  - เพิ่มปุ่ม “แก้ไข” ด้านล่างรายการลูกค้า (ใช้สไตล์เดียวกับ “เลือก”) และทำให้กลับมาแก้ไขได้ด้วย `PUT`
- ปรับตารางรายการสินค้าบริษัทให้หัวคอลัมน์/ข้อมูล “ชื่อสินค้า, ราคา, หน่วย, รหัส” อยู่กึ่งกลาง (`app/globals.css` สำหรับ `#productTable`)

## ไฟล์สำคัญที่มีการแก้ไข

- `app/page.tsx`
- `components/QuoteForm.tsx`
- `app/customer/page.tsx`
- `app/api/customers/[id]/route.ts`
- `app/layout.tsx`
- `app/favicon.ico`
- `app/globals.css`
- `lib/supabase/database.types.ts`

## คำสั่งที่รันเพื่อเช็คงาน

- `npm run gen:types`
- `npm run lint`
- `npm run build`

